<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Solution: Multi-Account AWS Disk Monitoring</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: "Warm Neutral Harmony" - A palette of warm grays and off-whites (slate, stone) with a supportive teal accent for calls to action and highlights, creating a professional and calm user experience. -->
    <!-- Application Structure Plan: The application is designed as a single-page, vertically scrolling narrative dashboard. The user flow begins with a high-level problem statement, then moves to an interactive architectural diagram where clicking components reveals details. This is followed by sections for implementation specifics (like Ansible code), a simulated live dashboard with filtering, and finally, deep dives into scalability and security. This thematic, non-linear structure was chosen to allow different personas (e.g., a CTO, an architect) to engage with the content at their desired level of detail, making a dense technical report more accessible and explorable. The core interaction is the architectural explorer, which directly translates the report's main diagram into an interactive learning tool. -->
    <!-- Visualization & Content Choices: 
        - Report Info: High-Level Architecture -> Goal: Organize/Relationships -> Viz/Method: Interactive Diagram (HTML/CSS/JS) -> Interaction: Click component to show modal with details. -> Justification: Transforms a static diagram into the central, exploratory hub of the application, promoting user engagement. -> Library/Method: Vanilla JS with Tailwind CSS.
        - Report Info: Disk Utilization Data -> Goal: Compare/Inform -> Viz/Method: Bar Chart -> Interaction: Filter by Account/Region. -> Justification: Provides a tangible, "easily digestible" example of the solution's output, demonstrating the end-user value. -> Library/Method: Chart.js.
        - Report Info: Ansible Playbook -> Goal: Inform -> Viz/Method: Formatted Code Block -> Interaction: Static view. -> Justification: Presents technical code clearly and accurately for expert review. -> Library/Method: HTML `<pre><code>`.
        - Report Info: Scalability/Security Details -> Goal: Inform -> Viz/Method: Accordion/Card Layout -> Interaction: Click to expand/reveal text. -> Justification: Manages information density, keeping the UI clean while allowing users to drill down into specific topics of interest without being overwhelmed. -> Library/Method: Vanilla JS with Tailwind CSS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #1e293b; /* slate-800 */
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 50vh;
            max-height: 450px;
            width: 100%;
            max-width: 900px;
        }
        .component {
            transition: all 0.3s ease-in-out;
            cursor: pointer;
        }
        .component:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .active-nav {
            color: #0f766e; /* teal-600 */
            font-weight: 600;
        }
        .modal {
            transition: opacity 0.25s ease;
        }
    </style>
</head>
<body class="bg-slate-50">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-40 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-slate-700">AWS Monitoring Solution</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#problem" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-teal-600">Problem</a>
                        <a href="#architecture" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-teal-600">Architecture</a>
                        <a href="#implementation" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-teal-600">Implementation</a>
                        <a href="#dashboard" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-teal-600">Live Demo</a>
                        <a href="#scalability" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-teal-600">Scalability</a>
                        <a href="#security" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-teal-600">Security</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        
        <section id="problem" class="text-center py-16">
            <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Solving Multi-Account EC2 Disk Utilization Monitoring</h2>
            <p class="mt-6 max-w-3xl mx-auto text-lg leading-8 text-slate-600">A large enterprise, expanded through acquisitions, faces fragmented visibility into EC2 disk utilization across numerous AWS accounts. The CTO requires a comprehensive, scalable solution to proactively monitor disk space, leveraging the company's existing Ansible tooling to mitigate operational risks like outages and performance degradation.</p>
        </section>

        <section id="architecture" class="py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-900">Interactive Architecture Explorer</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">This solution uses a hub-and-spoke model for security, scalability, and efficiency. Click on any component in the diagram below to learn more about its role, function, and implementation details within the monitoring framework.</p>
            </div>
            
            <div id="architecture-diagram" class="relative bg-white p-6 md:p-10 rounded-xl shadow-lg border border-slate-200">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-start">
                    
                    <div class="md:col-span-1 space-y-6">
                         <div id="comp-ansible" class="component bg-teal-50 border-2 border-dashed border-teal-500 p-4 rounded-lg text-center" data-component="ansible">
                            <h3 class="font-bold text-teal-800">Ansible Control Plane</h3>
                            <p class="text-sm text-teal-700">EC2 in Shared Services Account</p>
                            <span class="mt-2 inline-block text-2xl">‚öôÔ∏è</span>
                        </div>
                        <div class="text-center text-slate-500 text-3xl font-thin">‚Üì</div>
                         <div id="comp-iam" class="component bg-amber-50 border-2 border-dashed border-amber-500 p-4 rounded-lg text-center" data-component="iam">
                            <h3 class="font-bold text-amber-800">Cross-Account IAM Roles</h3>
                            <p class="text-sm text-amber-700">Secure, Temporary Access</p>
                             <span class="mt-2 inline-block text-2xl">üîë</span>
                        </div>
                    </div>

                    <div class="md:col-span-1 space-y-4">
                        <h4 class="text-center font-semibold text-slate-500">Spoke Accounts (Workloads)</h4>
                        <div id="comp-spoke-a" class="component bg-slate-100 p-4 rounded-lg text-center border border-slate-200" data-component="spoke">
                            <h3 class="font-semibold text-slate-700">Account A</h3>
                            <p class="text-sm text-slate-500">EC2 Instances w/ SSM Agent</p>
                        </div>
                         <div id="comp-spoke-b" class="component bg-slate-100 p-4 rounded-lg text-center border border-slate-200" data-component="spoke">
                            <h3 class="font-semibold text-slate-700">Account B</h3>
                            <p class="text-sm text-slate-500">EC2 Instances w/ SSM Agent</p>
                        </div>
                         <div id="comp-spoke-c" class="component bg-slate-100 p-4 rounded-lg text-center border border-slate-200" data-component="spoke">
                            <h3 class="font-semibold text-slate-700">Account C ...</h3>
                            <p class="text-sm text-slate-500">EC2 Instances w/ SSM Agent</p>
                        </div>
                    </div>
                    
                    <div class="md:col-span-1 space-y-6">
                        <div id="comp-s3" class="component bg-sky-50 border-2 border-dashed border-sky-500 p-4 rounded-lg text-center" data-component="s3">
                            <h3 class="font-bold text-sky-800">Central S3 Bucket</h3>
                            <p class="text-sm text-sky-700">Raw Data Storage</p>
                             <span class="mt-2 inline-block text-2xl">üóÑÔ∏è</span>
                        </div>
                        <div class="text-center text-slate-500 text-3xl font-thin">‚Üì</div>
                         <div id="comp-processing" class="component bg-violet-50 border-2 border-dashed border-violet-500 p-4 rounded-lg text-center" data-component="processing">
                            <h3 class="font-bold text-violet-800">Data Processing & Viz</h3>
                            <p class="text-sm text-violet-700">Lambda, CloudWatch, etc.</p>
                             <span class="mt-2 inline-block text-2xl">üìä</span>
                        </div>
                    </div>
                </div>
                 <div class="absolute inset-0 flex items-center justify-center -z-10">
                    <div class="w-full h-px bg-slate-200"></div>
                    <div class="w-px h-full bg-slate-200"></div>
                </div>
            </div>
        </section>

        <section id="implementation" class="py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-900">Implementation Deep Dive</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">This section provides the core technical assets for the solution: the dynamic inventory configuration and the main Ansible playbook used for collecting disk metrics.</p>
            </div>
            <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                <div class="p-6 md:p-8">
                    <h3 class="text-xl font-bold text-slate-800 mb-4">Ansible Playbook: `disk_monitor.yml`</h3>
                    <p class="text-slate-600 mb-6">This playbook uses the `shell` module to execute `df -h` on target Linux instances, parses the output, constructs a JSON payload, and uploads it to the central S3 bucket. It's designed to be run periodically via cron or a CI/CD pipeline.</p>
                    <div class="bg-slate-900 rounded-lg p-4 text-sm text-slate-200 overflow-x-auto">
                        <pre><code>---
---
- name: Collect EC2 Disk Utilization
  hosts: all
  gather_facts: no

  vars:
    s3_bucket_name: "central-monitoring-s3-bucket"
    s3_region: "us-east-1"
    disk_collection_script_content: "{{ lookup('file', 'files/generic_disk_script.sh') }}"

  tasks:
    - name: Debug EC2 instance IDs being targeted (optional)
      debug:
        msg: "Targeting instance ID: {{ hostvars[item].ec2_instance_id | default('N/A') }}"
      loop: "{{ ansible_play_batch }}"
      when: hostvars[item].ec2_instance_id is defined

    - name: Execute generic disk utilization script via SSM
      amazon.aws.aws_ssm:
        state: "command"
        document_name: "AWS-RunShellScript"
        instance_ids: "{{ ansible_play_batch | map('extract', hostvars, 'ec2_instance_id') | list }}"
        parameters:
          commands:
            - "{{ disk_collection_script_content }}"
        region: "{{ s3_region }}"
      register: ssm_command_init_result
      delegate_to: localhost

    - name: Wait for SSM command to complete for each instance
      amazon.aws.aws_ssm_info:
        command_id: "{{ ssm_command_init_result.command.CommandId }}"
        instance_id: "{{ item }}"
        region: "{{ s3_region }}"
      register: ssm_command_poll_result
      loop: "{{ ansible_play_batch | map('extract', hostvars, 'ec2_instance_id') | list }}"
      loop_control:
        loop_var: instance_id
      until: ssm_command_poll_result.command.InvocationResult.Status in ['Success', 'Failed', 'Cancelled']
      retries: 30
      delay: 10

    - name: Process and Upload output to S3
      ansible.builtin.include_tasks: process_and_upload_output.yml
      loop: "{{ ssm_command_poll_result.results }}"
      loop_control:
        loop_var: result_item
      when:
        - result_item.command.InvocationResult.Status == 'Success'
        - result_item.command.InvocationResult.StandardOutputContent is defined
        - result_item.command.InvocationResult.StandardOutputContent | length > 0
</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <section id="dashboard" class="py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-900">Simulated Monitoring Dashboard</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">This is a live demonstration of the final, aggregated data. The dashboard provides a unified view of disk utilization across all accounts and instances. Use the filters to dynamically update the chart and explore the data.</p>
            </div>
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-slate-200">
                <div class="flex flex-col sm:flex-row gap-4 mb-6">
                    <div>
                        <label for="account-filter" class="block text-sm font-medium text-slate-700">Filter by Account</label>
                        <select id="account-filter" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-slate-300 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-md">
                            <option>All Accounts</option>
                            <option>Account A (111122223333)</option>
                            <option>Account B (444455556666)</option>
                            <option>Account C (777788889999)</option>
                        </select>
                    </div>
                     <div>
                        <label for="threshold-filter" class="block text-sm font-medium text-slate-700">Utilization > (%)</label>
                        <input type="range" id="threshold-filter" min="0" max="100" value="0" class="mt-2 w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                        <span id="threshold-value" class="text-sm text-slate-500">0%</span>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="diskUtilizationChart"></canvas>
                </div>
            </div>
        </section>

        <section id="scalability" class="py-16">
             <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-900">Scalability and Future-Proofing</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">The solution is designed to scale seamlessly with enterprise growth. Key architectural choices ensure that onboarding new accounts and thousands of instances is an automated and efficient process.</p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                    <h3 class="font-bold text-lg text-slate-800">AWS Organizations Integration</h3>
                    <p class="mt-2 text-slate-600">New AWS accounts are simply invited to the Organization, immediately placing them under the central governance and security model enforced by Service Control Policies (SCPs).</p>
                </div>
                 <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                    <h3 class="font-bold text-lg text-slate-800">Automated IAM Deployment</h3>
                    <p class="mt-2 text-slate-600">Using Infrastructure as Code (CloudFormation StackSets or Terraform), the required `AnsibleDiskMonitorRole` is automatically and consistently deployed to new accounts.</p>
                </div>
                 <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                    <h3 class="font-bold text-lg text-slate-800">Ansible Dynamic Inventory</h3>
                    <p class="mt-2 text-slate-600">The `aws_ec2` plugin automatically discovers new instances across all accounts, eliminating manual inventory management and enabling playbooks to scale effortlessly.</p>
                </div>
            </div>
        </section>
        
        <section id="security" class="py-16">
             <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-900">Security by Design</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">Security is a foundational pillar of this solution, with best practices embedded at every layer to protect data and infrastructure.</p>
            </div>
            <div class="space-y-4">
                <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                    <h3 class="font-bold text-lg text-slate-800">IAM Least Privilege</h3>
                    <p class="mt-2 text-slate-600">Roles are configured with the absolute minimum permissions required. The spoke account role, for example, is limited to executing SSM commands and cannot modify or delete resources.</p>
                </div>
                 <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                    <h3 class="font-bold text-lg text-slate-800">Network Security</h3>
                    <p class="mt-2 text-slate-600">Using SSM for command execution eliminates the need for open inbound SSH ports on instances. All traffic to AWS services can be kept private within the AWS network using VPC Endpoints, preventing exposure to the public internet.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                    <h3 class="font-bold text-lg text-slate-800">Data Encryption & Auditing</h3>
                    <p class="mt-2 text-slate-600">Data is encrypted in transit (TLS) and at rest (SSE-S3/KMS). All API calls and role assumptions are logged in AWS CloudTrail for a complete audit trail.</p>
                </div>
            </div>
        </section>

    </main>
    
    <div id="component-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300">
            <div class="sticky top-0 bg-white border-b border-slate-200 p-4 flex justify-between items-center">
                <h3 id="modal-title" class="text-xl font-bold text-slate-800">Component Details</h3>
                <button id="modal-close" class="text-slate-500 hover:text-slate-800">&times;</button>
            </div>
            <div id="modal-content" class="p-6 text-slate-600 leading-relaxed">
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const componentData = {
                ansible: {
                    title: 'Ansible Control Plane',
                    content: `
                        <p>This is the central orchestrator of the entire solution, typically an EC2 instance running Ansible (or AWX/Ansible Tower for enterprise use). It is located in a dedicated <strong>Shared Services/Monitoring account</strong> to separate operational tooling from the highly privileged AWS Organization Management Account.</p>
                        <ul class="list-disc list-inside mt-4 space-y-2">
                            <li><strong>Function:</strong> Executes playbooks to collect metrics from all target instances.</li>
                            <li><strong>Execution:</strong> Uses the <strong>aws_ssm</strong> module to run commands via AWS Systems Manager (SSM), avoiding the need for direct SSH access.</li>
                            <li><strong>Credentials:</strong> Leverages an IAM Instance Profile, eliminating hardcoded access keys.</li>
                        </ul>
                    `
                },
                iam: {
                    title: 'Cross-Account IAM Roles',
                    content: `
                        <p>Secure access between accounts is achieved using temporary credentials provided by IAM roles, which is a critical security best practice that avoids using long-lived access keys.</p>
                        <ul class="list-disc list-inside mt-4 space-y-2">
                            <li><strong>AnsibleControlPlaneRole:</strong> Located in the Shared Services account, this role is assumed by the Ansible EC2 instance. It has permission to assume roles in other accounts (sts:AssumeRole).</li>
                            <li><strong>AnsibleDiskMonitorRole:</strong> Deployed in each spoke account. It trusts the AnsibleControlPlaneRole and grants the minimal permissions needed for monitoring (e.g., ssm:SendCommand, ec2:DescribeInstances).</li>
                            <li><strong>Principle of Least Privilege:</strong> This two-tiered role structure ensures that each component has only the permissions it needs to function, drastically reducing the potential blast radius in case of a compromise.</li>
                        </ul>
                    `
                },
                spoke: {
                    title: 'Spoke Accounts & EC2 Instances',
                    content: `
                        <p>These are the individual AWS accounts (e.g., Account A, B, C) that contain the workload EC2 instances requiring monitoring. They are members of the central AWS Organization.</p>
                        <ul class="list-disc list-inside mt-4 space-y-2">
                            <li><strong>EC2 Instances:</strong> The target servers where applications are running and disk space needs to be monitored.</li>
                            <li><strong>SSM Agent:</strong> Each instance must have the AWS Systems Manager (SSM) Agent installed and running. This agent communicates securely with the SSM service, allowing for remote command execution without inbound open ports.</li>
                            <li><strong>IAM Role:</strong> Each instance has the <strong>AnsibleDiskMonitorRole</strong> attached, granting SSM permission to execute the disk utilization script.</li>
                        </ul>
                    `
                },
                 s3: {
                    title: 'Central S3 Bucket',
                    content: `
                        <p>A single, centralized S3 bucket in the Shared Services/Monitoring account serves as the durable, scalable, and cost-effective repository for all raw monitoring data.</p>
                        <ul class="list-disc list-inside mt-4 space-y-2">
                            <li><strong>Purpose:</strong> Stores the raw JSON output from the Ansible playbook.</li>
                            <li><strong>Structure:</strong> Data is organized with a logical key structure (e.g., <code>/raw/account_id/instance_id/timestamp.json</code>) to facilitate efficient querying and processing.</li>
                            <li><strong>Security:</strong> The bucket is configured with versioning, default encryption (SSE-S3 or SSE-KMS), and a restrictive bucket policy that only allows writes from the Ansible Control Plane's IAM role.</li>
                        </ul>
                    `
                },
                 processing: {
                    title: 'Data Processing, Visualization & Alerting',
                    content: `
                        <p>Once data lands in S3, it is processed and routed to various services to create actionable insights. This pipeline transforms raw data into a digestible format.</p>
                        <ul class="list-disc list-inside mt-4 space-y-2">
                            <li><strong>Data Processing (Lambda/Glue):</strong> An S3 event can trigger a Lambda function to process new data in near real-time, or an AWS Glue job can run periodically for batch processing. This step normalizes data and pushes it to other services.</li>
                            <li><strong>Metrics & Dashboards (CloudWatch):</strong> The processed data populates CloudWatch Custom Metrics, which are then visualized on CloudWatch Dashboards.</li>
                            <li><strong>Alerting (CloudWatch Alarms & SNS):</strong> Alarms are set on the custom metrics (e.g., disk > 85%). When triggered, they publish a message to an SNS topic, which can notify teams via email, Slack, PagerDuty, etc.</li>
                        </ul>
                    `
                }
            };
            
            const modal = document.getElementById('component-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            const modalClose = document.getElementById('modal-close');

            document.querySelectorAll('.component').forEach(comp => {
                comp.addEventListener('click', () => {
                    const componentId = comp.dataset.component;
                    const data = componentData[componentId];
                    if (data) {
                        modalTitle.textContent = data.title;
                        modalContent.innerHTML = data.content;
                        modal.classList.remove('opacity-0', 'pointer-events-none');
                        modal.querySelector('div > div').classList.remove('scale-95');
                    }
                });
            });

            const closeModal = () => {
                modal.classList.add('opacity-0', 'pointer-events-none');
                modal.querySelector('div > div').classList.add('scale-95');
            };

            modalClose.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });
            
            const mockData = [
                { account: 'Account A (111122223333)', instance: 'i-01a', utilization: 88, mount: '/var/log' },
                { account: 'Account A (111122223333)', instance: 'i-01b', utilization: 45, mount: '/data' },
                { account: 'Account A (111122223333)', instance: 'i-01c', utilization: 92, mount: '/' },
                { account: 'Account B (444455556666)', instance: 'i-02a', utilization: 23, mount: '/app' },
                { account: 'Account B (444455556666)', instance: 'i-02b', utilization: 78, mount: '/' },
                { account: 'Account C (777788889999)', instance: 'i-03a', utilization: 65, mount: '/data' },
                { account: 'Account C (777788889999)', instance: 'i-03b', utilization: 95, mount: '/var' },
                { account: 'Account C (777788889999)', instance: 'i-03c', utilization: 15, mount: '/opt' },
                { account: 'Account C (777788889999)', instance: 'i-03d', utilization: 55, mount: '/' },
            ];

            const ctx = document.getElementById('diskUtilizationChart').getContext('2d');
            let diskChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Disk Utilization %',
                        data: [],
                        backgroundColor: [],
                        borderColor: [],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Utilization (%)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Instance ID & Mount Point'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const dataPoint = context.dataset.data[context.dataIndex];
                                    const originalData = context.chart.config.options.originalData[context.dataIndex];
                                    return `Account: ${originalData.account}`;
                                }
                            }
                        }
                    }
                }
            });

            const accountFilter = document.getElementById('account-filter');
            const thresholdFilter = document.getElementById('threshold-filter');
            const thresholdValue = document.getElementById('threshold-value');

            const updateChart = () => {
                const selectedAccount = accountFilter.value;
                const threshold = parseInt(thresholdFilter.value);
                
                thresholdValue.textContent = `${threshold}%`;

                const filteredData = mockData.filter(d => {
                    const accountMatch = selectedAccount === 'All Accounts' || d.account === selectedAccount;
                    const thresholdMatch = d.utilization >= threshold;
                    return accountMatch && thresholdMatch;
                });

                diskChart.data.labels = filteredData.map(d => `${d.instance} (${d.mount})`);
                diskChart.data.datasets[0].data = filteredData.map(d => d.utilization);
                diskChart.data.datasets[0].backgroundColor = filteredData.map(d => d.utilization > 90 ? 'rgba(239, 68, 68, 0.6)' : d.utilization > 75 ? 'rgba(245, 158, 11, 0.6)' : 'rgba(13, 148, 136, 0.6)');
                diskChart.data.datasets[0].borderColor = filteredData.map(d => d.utilization > 90 ? 'rgba(239, 68, 68, 1)' : d.utilization > 75 ? 'rgba(245, 158, 11, 1)' : 'rgba(13, 148, 136, 1)');
                diskChart.config.options.originalData = filteredData;
                diskChart.update();
            };

            accountFilter.addEventListener('change', updateChart);
            thresholdFilter.addEventListener('input', updateChart);

            updateChart();
            
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link');

            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 80) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active-nav');
                    if (link.getAttribute('href').includes(current)) {
                        link.classList.add('active-nav');
                    }
                });
            });

        });
    </script>
</body>
</html>
